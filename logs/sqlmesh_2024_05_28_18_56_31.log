2024-05-28 18:56:31,321 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:294)
2024-05-28 18:56:31,671 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:290)
2024-05-28 18:56:41,521 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__splice_case_study (evaluator.py:266)
2024-05-28 18:56:41,522 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1834)
2024-05-28 18:56:41,525 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1834)
2024-05-28 18:56:41,526 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__splice_case_study' AND table_name IN ('splice_case_study__seed_model__84995534__temp', 'splice_case_study__seed_model__84995534', 'splice_case_study__incremental_model__4290955__temp', 'splice_case_study__incremental_model__4290955') (base.py:1834)
2024-05-28 18:56:41,554 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__splice_case_study' (evaluator.py:850)
2024-05-28 18:56:41,554 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__splice_case_study" (base.py:1834)
2024-05-28 18:56:41,562 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__splice_case_study.splice_case_study__incremental_model__4290955__temp' (evaluator.py:1160)
2024-05-28 18:56:41,563 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__splice_case_study"."splice_case_study__incremental_model__4290955__temp" ("month" DATE, "user_id" BIGINT, "cohort_month" DATE, "customer_flag" INT) (base.py:1834)
2024-05-28 18:56:41,564 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'splice_case_study.incremental_model' (evaluator.py:1180)
2024-05-28 18:56:41,564 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "seed_model"."month" AS "month", "seed_model"."user_id" AS "user_id", "seed_model"."cohort_month" AS "cohort_month", "seed_model"."customer_flag" AS "customer_flag" FROM "db"."sqlmesh__splice_case_study"."splice_case_study__seed_model__84995534__temp" AS "seed_model" WHERE ("seed_model"."month" <= CAST('1970-01-01' AS DATE) AND "seed_model"."month" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:1834)
2024-05-28 18:56:41,570 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__splice_case_study.splice_case_study__incremental_model__4290955' (evaluator.py:1160)
2024-05-28 18:56:41,571 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__splice_case_study"."splice_case_study__incremental_model__4290955" ("month" DATE, "user_id" BIGINT, "cohort_month" DATE, "customer_flag" INT) (base.py:1834)
2024-05-28 18:56:42,008 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1716854400000, 1716940800000) for snapshot SnapshotId<"db"."splice_case_study"."seed_model": 1168379772> (engine_adapter.py:600)
2024-05-28 18:56:42,016 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."splice_case_study"."incremental_model": 766070203> (evaluator.py:480)
2024-05-28 18:56:42,021 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2023-06-01 00:00:00+00:00, 2024-05-29 00:00:00+00:00) into db.sqlmesh__splice_case_study.splice_case_study__incremental_model__4290955__temp' (evaluator.py:505)
2024-05-28 18:56:42,021 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__splice_case_study"."splice_case_study__incremental_model__4290955__temp" WHERE "month" BETWEEN CAST('2023-06-01' AS DATE) AND CAST('2024-05-28' AS DATE) (base.py:1834)
2024-05-28 18:56:42,023 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__splice_case_study"."splice_case_study__incremental_model__4290955__temp" ("month", "user_id", "cohort_month", "customer_flag") SELECT "month", "user_id", "cohort_month", "customer_flag" FROM (SELECT "seed_model"."month" AS "month", "seed_model"."user_id" AS "user_id", "seed_model"."cohort_month" AS "cohort_month", "seed_model"."customer_flag" AS "customer_flag" FROM "db"."sqlmesh__splice_case_study"."splice_case_study__seed_model__84995534__temp" AS "seed_model" WHERE "seed_model"."month" <= CAST('2024-05-28' AS DATE) AND "seed_model"."month" >= CAST('2023-06-01' AS DATE)) AS "_subquery" WHERE "month" BETWEEN CAST('2023-06-01' AS DATE) AND CAST('2024-05-28' AS DATE) (base.py:1834)
2024-05-28 18:56:42,023 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding dev interval (1685577600000, 1716940800000) for snapshot SnapshotId<"db"."splice_case_study"."incremental_model": 766070203> (engine_adapter.py:600)
2024-05-28 18:56:42,031 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'dev' (common.py:119)
2024-05-28 18:56:42,053 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.splice_case_study__dev' (evaluator.py:850)
2024-05-28 18:56:42,053 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."splice_case_study__dev" (base.py:1834)
2024-05-28 18:56:42,054 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.splice_case_study__dev.seed_model' to point at table 'db.sqlmesh__splice_case_study.splice_case_study__seed_model__84995534__temp' (evaluator.py:1116)
2024-05-28 18:56:42,054 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."splice_case_study__dev"."seed_model" AS SELECT * FROM "db"."sqlmesh__splice_case_study"."splice_case_study__seed_model__84995534__temp" (base.py:1834)
2024-05-28 18:56:42,055 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.splice_case_study__dev.incremental_model' to point at table 'db.sqlmesh__splice_case_study.splice_case_study__incremental_model__4290955__temp' (evaluator.py:1116)
2024-05-28 18:56:42,055 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."splice_case_study__dev"."incremental_model" AS SELECT * FROM "db"."sqlmesh__splice_case_study"."splice_case_study__incremental_model__4290955__temp" (base.py:1834)
2024-05-28 18:56:42,056 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'dev' (common.py:197)
2024-05-28 18:56:42,074 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
