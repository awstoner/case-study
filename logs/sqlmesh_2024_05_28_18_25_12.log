2024-05-28 18:25:12,729 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for data files: {'db.db'} (connection.py:294)
2024-05-28 18:25:13,011 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:296)
2024-05-28 18:25:13,025 - MainThread - sqlmesh.core.config.connection - INFO - Using existing DuckDB adapter due to overlapping data file: db.db (connection.py:290)
2024-05-28 18:25:15,984 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema db.sqlmesh__sqlmesh_example (evaluator.py:266)
2024-05-28 18:25:15,985 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1834)
2024-05-28 18:25:15,985 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT CURRENT_CATALOG() (base.py:1834)
2024-05-28 18:25:15,987 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT table_name AS name, table_schema AS schema, CASE table_type WHEN 'BASE TABLE' THEN 'table' WHEN 'VIEW' THEN 'view' WHEN 'LOCAL TEMPORARY' THEN 'table' END AS type FROM information_schema.tables WHERE table_schema = 'sqlmesh__sqlmesh_example' AND table_name IN ('sqlmesh_example__full_model__293592804', 'sqlmesh_example__incremental_model__67103854', 'sqlmesh_example__incremental_model__67103854__temp', 'sqlmesh_example__seed_model__3678911774__temp', 'sqlmesh_example__seed_model__3678911774', 'sqlmesh_example__full_model__293592804__temp') (base.py:1834)
2024-05-28 18:25:16,002 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh__sqlmesh_example' (evaluator.py:850)
2024-05-28 18:25:16,002 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh__sqlmesh_example" (base.py:1834)
2024-05-28 18:25:16,002 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__3678911774__temp' (evaluator.py:1160)
2024-05-28 18:25:16,003 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3678911774__temp" ("id" INT, "item_id" INT, "event_date" DATE, "nullz" INT) (base.py:1834)
2024-05-28 18:25:16,004 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__3678911774' (evaluator.py:1160)
2024-05-28 18:25:16,005 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3678911774" ("id" INT, "item_id" INT, "event_date" DATE, "nullz" INT) (base.py:1834)
2024-05-28 18:25:16,009 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3678911774" AS SELECT "id", "item_id", "event_date", "nullz" FROM "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__3678911774_191irb2d" (base.py:1834)
2024-05-28 18:25:16,010 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP TABLE IF EXISTS "db"."sqlmesh__sqlmesh_example"."__temp_sqlmesh_example__seed_model__3678911774_191irb2d" (base.py:1834)
2024-05-28 18:25:16,018 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__67103854__temp' (evaluator.py:1160)
2024-05-28 18:25:16,019 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__67103854__temp" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:1834)
2024-05-28 18:25:16,019 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.incremental_model' (evaluator.py:1180)
2024-05-28 18:25:16,019 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3678911774" AS "seed_model" WHERE ("seed_model"."event_date" <= CAST('1970-01-01' AS DATE) AND "seed_model"."event_date" >= CAST('1970-01-01' AS DATE)) AND FALSE LIMIT 0 (base.py:1834)
2024-05-28 18:25:16,025 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__67103854' (evaluator.py:1160)
2024-05-28 18:25:16,026 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__67103854" ("id" INT, "item_id" INT, "event_date" DATE) (base.py:1834)
2024-05-28 18:25:16,030 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__293592804__temp' (evaluator.py:1160)
2024-05-28 18:25:16,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__293592804__temp" ("item_id" INT, "num_orders" BIGINT) (base.py:1834)
2024-05-28 18:25:16,030 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Dry running model 'sqlmesh_example.full_model' (evaluator.py:1180)
2024-05-28 18:25:16,030 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__67103854" AS "incremental_model" WHERE FALSE GROUP BY "incremental_model"."item_id" LIMIT 0 (base.py:1834)
2024-05-28 18:25:16,033 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__293592804' (evaluator.py:1160)
2024-05-28 18:25:16,033 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__293592804" ("item_id" INT, "num_orders" BIGINT) (base.py:1834)
2024-05-28 18:25:16,052 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1716854400000, 1716940800000) for snapshot SnapshotId<"db"."sqlmesh_example"."seed_model": 1669676597> (engine_adapter.py:600)
2024-05-28 18:25:16,058 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 1157568531> (evaluator.py:480)
2024-05-28 18:25:16,062 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00+00:00, 2024-05-29 00:00:00+00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__67103854' (evaluator.py:505)
2024-05-28 18:25:16,063 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__67103854" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2024-05-28' AS DATE) (base.py:1834)
2024-05-28 18:25:16,065 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__67103854" ("id", "item_id", "event_date") SELECT "id", "item_id", "event_date" FROM (SELECT "seed_model"."id" AS "id", "seed_model"."item_id" AS "item_id", "seed_model"."event_date" AS "event_date" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3678911774" AS "seed_model" WHERE "seed_model"."event_date" <= CAST('2024-05-28' AS DATE) AND "seed_model"."event_date" >= CAST('2020-01-01' AS DATE)) AS "_subquery" WHERE "event_date" BETWEEN CAST('2020-01-01' AS DATE) AND CAST('2024-05-28' AS DATE) (base.py:1834)
2024-05-28 18:25:16,065 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1577836800000, 1716940800000) for snapshot SnapshotId<"db"."sqlmesh_example"."incremental_model": 1157568531> (engine_adapter.py:600)
2024-05-28 18:25:16,071 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2725159885> (evaluator.py:480)
2024-05-28 18:25:16,074 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2020-01-01 00:00:00+00:00, 2024-05-29 00:00:00+00:00) into db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__293592804' (evaluator.py:505)
2024-05-28 18:25:16,075 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE TABLE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__293592804" AS SELECT "incremental_model"."item_id" AS "item_id", COUNT(DISTINCT "incremental_model"."id") AS "num_orders" FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__67103854" AS "incremental_model" GROUP BY "incremental_model"."item_id" (base.py:1834)
2024-05-28 18:25:16,076 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Auditing snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2725159885> (evaluator.py:400)
2024-05-28 18:25:16,077 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DESCRIBE "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__293592804" (base.py:1834)
2024-05-28 18:25:16,079 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT COUNT(*) FROM (SELECT * FROM (SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__293592804" AS "sqlmesh_example__full_model__293592804") AS "_q_0" WHERE "item_id" < 0) AS "audit" (base.py:1834)
2024-05-28 18:25:16,080 - MainThread - sqlmesh.core.state_sync.engine_adapter - INFO - Adding interval (1577836800000, 1716940800000) for snapshot SnapshotId<"db"."sqlmesh_example"."full_model": 2725159885> (engine_adapter.py:600)
2024-05-28 18:25:16,088 - MainThread - sqlmesh.core.state_sync.common - INFO - Promoting environment 'dev' (common.py:119)
2024-05-28 18:25:16,097 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'db.sqlmesh_example__dev' (evaluator.py:850)
2024-05-28 18:25:16,097 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "db"."sqlmesh_example__dev" (base.py:1834)
2024-05-28 18:25:16,098 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.seed_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__seed_model__3678911774' (evaluator.py:1116)
2024-05-28 18:25:16,098 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."seed_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__seed_model__3678911774" (base.py:1834)
2024-05-28 18:25:16,099 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.incremental_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__incremental_model__67103854' (evaluator.py:1116)
2024-05-28 18:25:16,100 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."incremental_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__incremental_model__67103854" (base.py:1834)
2024-05-28 18:25:16,100 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'db.sqlmesh_example__dev.full_model' to point at table 'db.sqlmesh__sqlmesh_example.sqlmesh_example__full_model__293592804' (evaluator.py:1116)
2024-05-28 18:25:16,101 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE OR REPLACE VIEW "db"."sqlmesh_example__dev"."full_model" AS SELECT * FROM "db"."sqlmesh__sqlmesh_example"."sqlmesh_example__full_model__293592804" (base.py:1834)
2024-05-28 18:25:16,101 - MainThread - sqlmesh.core.state_sync.common - INFO - Finalizing environment 'dev' (common.py:197)
2024-05-28 18:25:16,117 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
